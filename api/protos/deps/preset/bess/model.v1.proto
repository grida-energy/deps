syntax = "proto3";

package deps.preset.bess.v1;

import "deps/model/esd/model.v1.proto";
import "deps/model/pcs/model.v1.proto";
import "deps/model/source/model.v1.proto";

import "deps/rpc/header.v1.proto";
import "google/protobuf/timestamp.proto";

// 배터리 + 인버터로 구성된 단순 BESS 모델
message Bess {
  // 배터리 모델
  .deps.model.esd.v1.EsdBank battery = 1;
  // PCS 모델
  .deps.model.pcs.v1.ThreePhasePcsPart pcs = 2;
  // Off Grid (부하 연결 부)
  .deps.model.pcs.v1.ThreePhaseGridPart off_grid = 3;
  // On Grid (계통 연결 부)
  .deps.model.pcs.v1.ThreePhaseGridPart on_grid = 4;
}

// BESS 계측 정보
message BessMeasure {
  // 타임 스탬프
  .google.protobuf.Timestamp timestamp = 1;
  // BESS 데이터
  Bess data = 2;
}

// BESS 명령
message BessCommand {
  oneof cmd {
    // 배터리 명령
    .deps.model.esd.v1.EsdBank.Command battery = 1;
    // PCS 명령
    .deps.model.pcs.v1.ThreePhasePcsPart.Command pcs = 2;
  }
}

// RPC 메시지
message Rpc {
  // BESS RPC 요청
  message BessRequest {
    // 요청 헤더
    .deps.rpc.v1.Request head = 1;
    // BESS 명령
    BessCommand data = 2;
  }
  // BESS RPC 응답
  message BessResponse {
    // 응답 헤더
    .deps.rpc.v1.Response head = 1;
  }
}

// PV 입력이 존재하는 BESS (모델에 대한 정제 필요)
message HybridBess {
  // 배터리 모델
  .deps.model.esd.v1.EsdBank battery = 1;
  // PCS 모델
  .deps.model.pcs.v1.ThreePhasePcsPart pcs = 2;
  // Off Grid (부하 연결 부)
  .deps.model.pcs.v1.ThreePhaseGridPart off_grid = 3;
  // On Grid (계통 연결 부)
  .deps.model.pcs.v1.ThreePhaseGridPart on_grid = 4;
  // PV 연결 부
  .deps.model.source.v1.PvLine pv = 5;
}

// 하이브리드 BESS 계측 정보
message HybridBessMeasure {
  // 타임 스탬프
  .google.protobuf.Timestamp timestamp = 1;
  // 하이브리드 BESS 데이터
  HybridBess data = 2;
}